{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_line_chart = _resolveComponent(\"line-chart\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_line_chart, {\n    \"chart-data\": $setup.chartData,\n    options: $setup.chartOptions\n  }, null, 8 /* PROPS */, [\"chart-data\", \"options\"])]);\n}","map":{"version":3,"names":["_createElementBlock","_createVNode","_component_line_chart","$setup","chartData","options","chartOptions"],"sources":["/Users/djahnickefrei/monProjet/bank-frontend/src/components/AccountChart.vue"],"sourcesContent":["<template>\n  <div>\n    <line-chart :chart-data=\"chartData\" :options=\"chartOptions\" />\n  </div>\n</template>\n\n<script>\nimport { ref, watchEffect } from 'vue';\nimport { LineChart } from 'vue-chart-3';\nimport { Chart, registerables } from 'chart.js';\nimport axios from 'axios';\n\nChart.register(...registerables);\n\nexport default {\n  components: {\n    LineChart,\n  },\n  props: {\n    accountId: {\n      type: Number,\n      required: true,\n    },\n  },methods: {\n  async fetchChartData() {\n    // Vous pouvez appeler la méthode fetchAccountDetailsAndTransactions\n    // ou toute autre méthode nécessaire pour actualiser les données\n    await this.fetchAccountDetailsAndTransactions();\n  }\n}\n,\n  setup(props) {\n    const chartData = ref({\n      labels: [],\n      datasets: [\n        {\n          label: 'Solde Initial',\n          backgroundColor: 'rgba(54, 162, 235, 0.5)',\n          borderColor: 'rgb(54, 162, 235)',\n          fill: false,\n          data: [],\n        },\n        {\n          label: 'Solde Actuel',\n          backgroundColor: 'rgba(255, 99, 132, 0.5)',\n          borderColor: 'rgb(255, 99, 132)',\n          fill: false,\n          data: [],\n        },\n        {\n          label: 'Total Dépenses',\n          backgroundColor: 'rgba(255, 255, 0, 0.5)',\n          borderColor: 'rgb(255, 255, 0)',\n          fill: false,\n          data: [],\n        },\n        {\n          label: 'Total Revenus',\n          backgroundColor: 'rgba(75, 192, 192, 0.5)',\n          borderColor: 'rgb(75, 192, 192)',\n          fill: false,\n          data: [],\n        },\n      ],\n    });\n\n    const chartOptions = ref({\n      responsive: true,\n      maintainAspectRatio: false,\n      scales: {\n        y: {\n          beginAtZero: false,\n        },\n      },\n      plugins: {\n        tooltip: {\n          enabled: true,\n          mode: 'nearest',\n          intersect: false,\n        },\n      },\n    });\n\n    async function fetchAccountDetailsAndTransactions() {\n      try {\n        const accountId = props.accountId;\n\n        const accountResponse = await axios.get(`http://localhost:3000/accounts/${accountId}`);\n        const accountDetails = accountResponse.data;\n\n        const transactionsResponse = await axios.get(`http://localhost:3000/accounts/${accountId}/transactions`);\n        const transactions = transactionsResponse.data;\n\n        // Tri des transactions par date\n        transactions.sort((a, b) => new Date(a.date) - new Date(b.date));\n\n        updateChartData(accountDetails, transactions);\n      } catch (error) {\n        console.error('Erreur lors de la récupération des données', error);\n      }\n    }\n\n    watchEffect(() => {\n      if (props.accountId) {\n        fetchAccountDetailsAndTransactions();\n      }\n    });\n\n    function updateChartData(accountDetails, transactions) {\n      chartData.value.labels = [];\n      chartData.value.datasets[0].data = []; // Solde Initial\n      chartData.value.datasets[1].data = []; // Solde Actuel\n      \n      let currentBalance = accountDetails.initialBalance;\n      let totalExpenses = 0;\n      let totalRevenues = 0;\n\n      transactions.forEach(transaction => {\n        const transactionDate = new Date(transaction.date).toLocaleDateString('fr-FR');\n        const amount = transaction.amount;\n\n        if (transaction.category.toLowerCase() === 'dépense') {\n          totalExpenses += Math.abs(amount);\n          currentBalance -= amount;\n        } else if (transaction.category.toLowerCase() === 'revenu') {\n          totalRevenues += amount;\n          currentBalance += amount;\n        }\n\n        chartData.value.labels.push(transactionDate);\n        chartData.value.datasets[0].data.push(accountDetails.initialBalance);\n        chartData.value.datasets[1].data.push(currentBalance);\n        chartData.value.datasets[2].data.push(totalExpenses);\n        chartData.value.datasets[3].data.push(totalRevenues);\n      });\n    }\n\n    return {\n      chartData,\n      chartOptions,\n    };\n  },\n};\n</script>\n\n<style scoped>\n/* Add your styles here */\n</style>"],"mappings":";;;uBACEA,mBAAA,CAEM,cADJC,YAAA,CAA8DC,qBAAA;IAAjD,YAAU,EAAEC,MAAA,CAAAC,SAAS;IAAGC,OAAO,EAAEF,MAAA,CAAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}